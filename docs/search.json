[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Jay Chung",
    "section": "",
    "text": "I am an independent bioinformatics consultant based in San Diego, CA.\nI have over 10 years of experience in computational biology."
  },
  {
    "objectID": "about.html#education",
    "href": "about.html#education",
    "title": "Jay Chung",
    "section": "Education",
    "text": "Education\nIcahn School of Medicine at Mount Sinai | PhD in Genetics & Genomics Sciences"
  },
  {
    "objectID": "about.html#experience",
    "href": "about.html#experience",
    "title": "Jay Chung",
    "section": "Experience",
    "text": "Experience\nPlexium | Associate Director Bioinformatics | 2023 - 2025\nPfizer | Senior Principal Scientst Epigenetics | 2019 - 2023\nSalk Institute | PostDoc Researcher | 2016 - 2019"
  },
  {
    "objectID": "posts/2025-11-29_depmap-multiomics-autoencoder/index.html",
    "href": "posts/2025-11-29_depmap-multiomics-autoencoder/index.html",
    "title": "Using machine learning to predict drug sensitivity from DepMap OMICS data (Part 1)",
    "section": "",
    "text": "This post explores the use of autoencoders to embed DepMap genomics data for drug sensitivity prediction."
  },
  {
    "objectID": "posts/2025-11-29_depmap-multiomics-autoencoder/index.html#introduction",
    "href": "posts/2025-11-29_depmap-multiomics-autoencoder/index.html#introduction",
    "title": "Using machine learning to predict drug sensitivity from DepMap OMICS data (Part 1)",
    "section": "Introduction",
    "text": "Introduction\nBackground: Cell panel drug screens are very costly and often result in only up to hundreds of cell lines available, limiting the power of sensitivity biomarker detection. By leveraging machine learning (ML) approaches, one can expand sensitivity prediction to thousands of DepMap cell lines and thus improve the power of biomarker detection.\nProblem: DepMap OMICS data are high-dimensional, and such high-dimensional data may hinder ML prediction due to overfitting problems and noisy data.\nProposal: By leveraging AutoEncoder (AE), a deep learning approach, high-dimensional OMICS data can be compressed into Deep Features (DF), thus overcoming the problem of overfitting and resulting in better drug sensitivity prediction accuracy.\nIn this post, we demonstrate how to use AE to compress DepMap RNA expression data alone and multi-omics data (RNA expression + mutation + CRISPR dependency scores) into deep features. We then visualize and compare the embeddings from RNA alone vs. multi-omics data."
  },
  {
    "objectID": "posts/2025-11-29_depmap-multiomics-autoencoder/index.html#setup-and-libraries",
    "href": "posts/2025-11-29_depmap-multiomics-autoencoder/index.html#setup-and-libraries",
    "title": "Using machine learning to predict drug sensitivity from DepMap OMICS data (Part 1)",
    "section": "Setup and Libraries",
    "text": "Setup and Libraries\n\n\nCode\nlibrary(tidyverse)\nlibrary(data.table)\nlibrary(ggpubr)\nlibrary(h2o)\nlibrary(umap)\nlibrary(ggrepel)\nlibrary(microViz)"
  },
  {
    "objectID": "posts/2025-11-29_depmap-multiomics-autoencoder/index.html#aim-1-rna-expression-autoencoder",
    "href": "posts/2025-11-29_depmap-multiomics-autoencoder/index.html#aim-1-rna-expression-autoencoder",
    "title": "Using machine learning to predict drug sensitivity from DepMap OMICS data (Part 1)",
    "section": "Aim 1: RNA Expression Autoencoder",
    "text": "Aim 1: RNA Expression Autoencoder\nFirst, we use an autoencoder to embed cell lines based on RNA expression data alone.\n\nData Loading and Preprocessing\nWe filter for high-variance genes to reduce noise and dimensionality before feeding the data into the autoencoder.\n\n\nCode\n# load data: RNA expression\n# Note: Adjust paths as needed\nload(\"CCLE_24Q2_GE_match_sample_info.RData\")\nload(\"sample_info_match_biomarkers.RData\")\n\n# remove low variance genes\nge_var &lt;- apply(ccle_ge_match_sam, 2, var, na.rm = TRUE) \n# plot(density(ge_var)) \n# abline(v = quantile(ge_var, 0.2)) \nge_dat_hv &lt;- ccle_ge_match_sam[, which(ge_var &gt; quantile(ge_var, 0.2))] \n\n# remove any cell lines (rows) that contains NAs\nge_dat_hv &lt;- ge_dat_hv |&gt; na.omit()\n\n# standardize the data\nge_dat_hv &lt;- scale(ge_dat_hv) |&gt; as.data.frame()\n\n\n\n\nModel Training\nWe perform a hyperparameter grid search to find the optimal autoencoder architecture.\n\n\nCode\n# Hyperparameter search grid to find best AE model\nh2o.init(nthreads = 20, max_mem_size = \"60G\")\nrna_h2o &lt;- as.h2o(ge_dat_hv) \n\nhyper_grid &lt;- list(hidden = list(\n  c(1000, 500, 1000),\n  c(1000, 500, 200, 500, 1000), \n  c(1000, 100, 50, 100, 1000),\n  c(1000, 500, 100, 500, 1000), \n  c(2000, 1000, 200, 1000, 2000), \n  c(1000, 500, 300, 500, 1000)\n))\n\nae_grid &lt;- h2o.grid(\n  algorithm = \"deeplearning\",\n  x = colnames(rna_h2o), \n  training_frame = rna_h2o,\n  grid_id = \"RNA_ae1\",\n  autoencoder = TRUE,\n  activation = \"TanhWithDropout\", \n  hyper_params = hyper_grid,\n  nesterov_accelerated_gradient = TRUE, \n  epochs = 30,\n  stopping_rounds = 5, \n  seed = 524\n)\n\n# AE learning with best parameters (selected from grid search)\nae_model &lt;- h2o.deeplearning(\n  x = colnames(rna_h2o), \n  training_frame = rna_h2o,\n  autoencoder = TRUE,\n  hidden = c(1000, 500, 200, 500, 1000),\n  hidden_dropout_ratios = c(0.5, 0.5, 0.5, 0.5, 0.5),\n  activation = \"TanhWithDropout\",\n  epochs = 30,\n  stopping_rounds = 5, \n  nesterov_accelerated_gradient = TRUE, \n  seed = 524\n)\n\n# extract the compressed features\ncompressed_features &lt;- h2o.deepfeatures(ae_model, rna_h2o, layer = 3) |&gt; as.data.frame()\nrownames(compressed_features) &lt;- rownames(ge_dat_hv)\n\n# Save results\nfwrite(compressed_features, file = \"./results/output_files/RNA_AE_compressed_features.csv\", sep = \",\", row.names = TRUE)\nh2o.shutdown()"
  },
  {
    "objectID": "posts/2025-11-29_depmap-multiomics-autoencoder/index.html#aim-2-multi-omics-autoencoder",
    "href": "posts/2025-11-29_depmap-multiomics-autoencoder/index.html#aim-2-multi-omics-autoencoder",
    "title": "Using machine learning to predict drug sensitivity from DepMap OMICS data (Part 1)",
    "section": "Aim 2: Multi-omics Autoencoder",
    "text": "Aim 2: Multi-omics Autoencoder\nNext, we integrate RNA expression, mutation data (DAMMUT, HOTMUT), and CRISPR dependency scores.\n\nData Integration\nWe process each data type separately (filtering, standardizing) and then combine them into a single multi-omics dataset.\n\n\nCode\n# load data\nload(\"CCLE_24Q2_GE_match_sample_info.RData\")\nload(\"DepMap_24Q2_Chronos_match_sample_info.RData\")\nload(\"CCLE_24Q2_DAMMUT_match_sample_info.RData\")\nload(\"CCLE_24Q2_HOTMUT_match_sample_info.RData\")\nload(\"sample_info_match_biomarkers.RData\")\n\n# RNA processing\nge_var &lt;- apply(ccle_ge_match_sam, 2, var, na.rm = TRUE)\nge_dat_hv &lt;- ccle_ge_match_sam[, which(ge_var &gt; quantile(ge_var, 0.2))]\nge_dat_hv &lt;- scale(ge_dat_hv) |&gt; as.data.frame()\n\n# Mutation processing\ndam_mut_dat_filt &lt;- dammut_dat_match_sam[, which(apply(na.omit(dammut_dat_match_sam), 2, function(x) sum(x != 0)) &gt; 20)]\nhot_mut_dat_filt &lt;- hotmut_dat_match_sam[, which(apply(na.omit(hotmut_dat_match_sam), 2, function(x) sum(x != 0)) &gt; 20)]\n\n# CRISPR processing\ncrispr_var &lt;- apply(chronos_dat_match_sam, 2, var, na.rm = TRUE)\ncrispr_dat_hv &lt;- chronos_dat_match_sam[, which(crispr_var &gt; quantile(crispr_var, 0.2))]\ncrispr_dat_hv &lt;- scale(crispr_dat_hv) |&gt; as.data.frame()\n\n# Combine data\ncolnames(ge_dat_hv) &lt;- paste0(colnames(ge_dat_hv),\"_RNA\")\ncolnames(dam_mut_dat_filt) &lt;- paste0(colnames(dam_mut_dat_filt),\"_DAMMUT\")\ncolnames(hot_mut_dat_filt) &lt;- paste0(colnames(hot_mut_dat_filt),\"_HOTMUT\")\ncolnames(crispr_dat_hv) &lt;- paste0(colnames(crispr_dat_hv),\"_CRISPR\")\n\nmulti_omics_dat &lt;- cbind(ge_dat_hv, dam_mut_dat_filt, hot_mut_dat_filt, crispr_dat_hv)\n\n# Remove rows with too many NAs\nmulti_omics_dat &lt;- multi_omics_dat[rowSums(is.na(multi_omics_dat)) &lt;= ncol(multi_omics_dat) * 0.8, ]\n\n\n\n\nMulti-omics Model Training\nWe train another autoencoder on this combined dataset.\n\n\nCode\nh2o.init(nthreads = 20, max_mem_size = \"60G\")\nrna_h2o &lt;- as.h2o(multi_omics_dat)\n\n# (Grid search code omitted for brevity, similar to Aim 1)\n\n# AE learning with best parameters\nae_model &lt;- h2o.deeplearning(\n  x = colnames(rna_h2o),\n  training_frame = rna_h2o,\n  autoencoder = TRUE,\n  hidden = c(1000, 500, 300, 500, 1000),\n  hidden_dropout_ratios = c(0.5, 0.5, 0.5, 0.5, 0.5),\n  activation = \"TanhWithDropout\",\n  epochs = 30,\n  stopping_rounds = 5, \n  nesterov_accelerated_gradient = TRUE, \n  seed = 524\n)\n\ncompressed_features &lt;- h2o.deepfeatures(ae_model, rna_h2o, layer = 3) |&gt; as.data.frame()\nrownames(compressed_features) &lt;- rownames(multi_omics_dat)\n\nfwrite(compressed_features, file = \"./results/output_files/MultiOmics_AE_compressed_features.csv\", sep = \",\", row.names = TRUE)\nh2o.shutdown()"
  },
  {
    "objectID": "posts/2025-11-29_depmap-multiomics-autoencoder/index.html#aim-3-visualization-and-comparison",
    "href": "posts/2025-11-29_depmap-multiomics-autoencoder/index.html#aim-3-visualization-and-comparison",
    "title": "Using machine learning to predict drug sensitivity from DepMap OMICS data (Part 1)",
    "section": "Aim 3: Visualization and Comparison",
    "text": "Aim 3: Visualization and Comparison\nFinally, we visualize the embeddings using UMAP and compare the clustering with known lineages.\n\nFull RNA UMAP (without Autoencoder)\n\n\nCode\nload(\"CCLE_24Q2_GE_match_sample_info.RData\")\nload(\"sample_info_match_biomarkers.RData\")\nge_var &lt;- apply(ccle_ge_match_sam, 2, var, na.rm = TRUE) # calculate variance for each gene\nplot(density(ge_var)) # plot variance density plot\nabline(v = quantile(ge_var, 0.2)) # select a cutoff\nsum(ge_var &gt; quantile(ge_var, 0.2)) # how many genes passed variance cutoff: 15322\nge_dat_hv &lt;- ccle_ge_match_sam[, which(ge_var &gt; quantile(ge_var, 0.2))] # select high variance genes\n# standardize the data\nge_dat_hv &lt;- scale(ge_dat_hv) |&gt; as.data.frame() |&gt; na.omit()\nsample_info &lt;- sample_info[match(rownames(ge_dat_hv), sample_info$StrippedCellLineName), ]\nall(rownames(ge_dat_hv) == sample_info$StrippedCellLineName)\nlibrary(umap)\numap_dat &lt;- umap(\n  ge_dat_hv, \n  n_components = 2,\n  n_neighbors = 50,\n  random_state = 524,\n  verbose = TRUE,\n  n_threads = 15\n)\numap_dat &lt;- as.data.frame(umap_dat$layout)\numap_dat$cell_line &lt;- sample_info$StrippedCellLineName\numap_dat$lineage &lt;- sample_info$OncotreeLineage\numap_dat$subtype &lt;- sample_info$OncotreeSubtype\nlibrary(ggrepel)\nlibrary(microViz)\nggplot(umap_dat, aes(V1, -V2, color = lineage, fill = lineage)) +\n  geom_point(size = 3, alpha = 0.5) + \n  scale_fill_manual(values = distinct_palette(n = length(unique(umap_dat$lineage)), pal = \"brewerPlus\", add = \"lightgrey\")) + \n  scale_color_manual(values = distinct_palette(n = length(unique(umap_dat$lineage)), pal = \"brewerPlus\", add = \"lightgrey\")) + \n  theme_classic(base_size = 20) + \n  # guides(fill = guide_legend(ncol = 1)) + \n  # add lineage labels at the center of each lineage cluster\n  geom_label_repel(\n    data = umap_dat %&gt;%\n      group_by(lineage) %&gt;%\n      summarize(V1 = median(V1), V2 = median(V2)),\n    aes(label = lineage, color = lineage),\n    size = 4,\n    # color = \"black\",\n    fill = \"white\",\n    alpha = 0.7,\n    show.legend = FALSE, \n    max.overlaps = 100\n  ) +\n  theme(legend.position = \"none\", \n        legend.title = element_text(size = 10), \n        legend.text = element_text(size = 10)\n  ) +\n  labs(x = \"UMAP1\", \n       y = \"UMAP2\", \n       title = \"UMAP of full CCLE RNA expression (no AE)\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nRNA deep features UMAP\n\n\nCode\n# Load compressed features\nRNA_AE_compressed_features &lt;- fread(\"./results/output_files/RNA_AE_compressed_features.csv\", data.table = FALSE) |&gt; \n  column_to_rownames(var = \"V1\")\nRNA_AE_compressed_features &lt;- RNA_AE_compressed_features[rowSums(RNA_AE_compressed_features) != 0, ]\n\n# Match with sample info\nsample_info &lt;- sample_info[match(rownames(RNA_AE_compressed_features), sample_info$StrippedCellLineName), ]\n\n# Run UMAP\numap_dat &lt;- umap(RNA_AE_compressed_features, n_components = 2, n_neighbors = 50, random_state = 524)\numap_dat &lt;- as.data.frame(umap_dat$layout)\numap_dat$lineage &lt;- sample_info$OncotreeLineage\n\n# Plot\nggplot(umap_dat, aes(V1, V2, color = lineage, fill = lineage)) +\n  geom_point(size = 3, alpha = 0.5) + \n  scale_fill_manual(values = distinct_palette(n = length(unique(umap_dat$lineage)), pal = \"brewerPlus\", add = \"lightgrey\")) + \n  scale_color_manual(values = distinct_palette(n = length(unique(umap_dat$lineage)), pal = \"brewerPlus\", add = \"lightgrey\")) + \n  theme_classic(base_size = 20) + \n  geom_label_repel(\n    data = umap_dat %&gt;% group_by(lineage) %&gt;% summarize(V1 = median(V1), V2 = median(V2)),\n    aes(label = lineage, color = lineage),\n    size = 4, fill = \"white\", alpha = 0.7, show.legend = FALSE, max.overlaps = 100\n  ) +\n  theme(legend.position = \"none\") +\n  labs(title = \"UMAP of AE compressed CCLE RNA expression\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nMulti-omics deep features UMAP\n\n\nCode\n# Load compressed features\nMultiOmics_AE_compressed_features &lt;- fread(\"./results/output_files/MultiOmics_AE_compressed_features.csv\", data.table = FALSE) |&gt; \n  column_to_rownames(var = \"V1\")\nMultiOmics_AE_compressed_features &lt;- MultiOmics_AE_compressed_features[rowSums(MultiOmics_AE_compressed_features) != 0, ]\n\n# Match with sample info\nsample_info &lt;- sample_info[match(rownames(MultiOmics_AE_compressed_features), sample_info$StrippedCellLineName), ]\n\n# Run UMAP\numap_dat &lt;- umap(MultiOmics_AE_compressed_features, n_components = 2, n_neighbors = 50, random_state = 524)\numap_dat &lt;- as.data.frame(umap_dat$layout)\numap_dat$lineage &lt;- sample_info$OncotreeLineage\n\n# Plot\nggplot(umap_dat, aes(-V1, -V2, color = lineage, fill = lineage)) +\n  geom_point(size = 3, alpha = 0.5) + \n  scale_fill_manual(values = distinct_palette(n = length(unique(umap_dat$lineage)), pal = \"brewerPlus\", add = \"lightgrey\")) + \n  scale_color_manual(values = distinct_palette(n = length(unique(umap_dat$lineage)), pal = \"brewerPlus\", add = \"lightgrey\")) + \n  theme_classic(base_size = 20) + \n  geom_label_repel(\n    data = umap_dat %&gt;% group_by(lineage) %&gt;% summarize(V1 = median(V1), V2 = median(V2)),\n    aes(label = lineage, color = lineage),\n    size = 4, fill = \"white\", alpha = 0.7, show.legend = FALSE, max.overlaps = 100\n  ) +\n  theme(legend.position = \"none\") +\n  labs(title = \"UMAP of AE compressed CCLE Multi-omics\")"
  },
  {
    "objectID": "posts/2025-11-29_depmap-multiomics-autoencoder/index.html#conclusions",
    "href": "posts/2025-11-29_depmap-multiomics-autoencoder/index.html#conclusions",
    "title": "Using machine learning to predict drug sensitivity from DepMap OMICS data (Part 1)",
    "section": "Conclusions",
    "text": "Conclusions\n\nRNA Deep Features: Preserve original transcriptomic landscape across DepMap cell lines.\nMulti-omics Deep Features: Reveal richer cell state structure than RNA alone.\nNext Steps: Compare prediction accuracy on independent test data (deep features vs. full omics)."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Data Science & Machine Learning for Biology",
    "section": "",
    "text": "Using machine learning to predict drug sensitivity from DepMap OMICS data (Part 1)\n\n\n\nR\n\nDepMap\n\nAutoencoder\n\nMulti-omics\n\nMachine Learning\n\n\n\n\n\n\n\n\n\nNov 29, 2025\n\n\nJay Chung\n\n\n\n\n\nNo matching items"
  }
]